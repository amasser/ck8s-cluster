image:
  tag: "1.7.8-alpine"

persistence:
  useExisting: false

setDefaultUser:
  user:
    username: demo
    password: {{ requiredEnv "INFLUXDB_PWD" }}

env:
- name: INFLUXDB_ADMIN_USER
  value: demo
- name: INFLUXDB_ADMIN_PASSWORD
  value: {{ requiredEnv "INFLUXDB_PWD" }}

config:
  http:
    auth_enabled: true

resources:
  requests:
    memory: 512Mi
    cpu: 0.3
  limits:
    memory: 4Gi
    cpu: 1.5

{{ if or (not (env "ECK_RESTORE_CLUSTER")) (not (eq (env "ECK_RESTORE_CLUSTER") "true")) }}
initScripts:
  enabled: true
  scripts:
    init.iql: |+
      CREATE DATABASE "service_cluster";
      CREATE DATABASE "workload_cluster"
{{ end }}
